(function(){"use strict";var t={9522:function(t,e,s){var a=s(9963),r=s(6252);const o={class:"container"};function i(t,e,s,a,i,n){const c=(0,r.up)("the-header"),l=(0,r.up)("user-auth"),d=(0,r.up)("chat-page"),u=(0,r.up)("base-alert");return(0,r.wg)(),(0,r.iD)("div",o,[this.$store.getters.userEmail?((0,r.wg)(),(0,r.j4)(c,{key:0})):(0,r.kq)("",!0),this.$store.getters.userEmail?((0,r.wg)(),(0,r.j4)(d,{key:2})):((0,r.wg)(),(0,r.j4)(l,{key:1})),i.hasError?((0,r.wg)(),(0,r.j4)(u,{key:3})):(0,r.kq)("",!0)])}var n=s(3577);const c=t=>((0,r.dD)("data-v-07cb488b"),t=t(),(0,r.Cn)(),t),l={class:"username"},d={class:"avatar"},u=c((()=>(0,r._)("h1",null,"TELEGRAF",-1)));function h(t,e,s,a,o,i){return(0,r.wg)(),(0,r.iD)("header",null,[(0,r._)("div",l,[(0,r._)("div",d,(0,n.zw)(this.$store.getters.userEmail[0].toUpperCase()),1),(0,r._)("p",null,(0,n.zw)(this.$store.getters.userEmail),1)]),u,(0,r._)("button",{onClick:e[0]||(e[0]=(...t)=>i.logout&&i.logout(...t))},"Logout")])}var g={methods:{logout(){this.$store.dispatch("logout")}}},m=s(3744);const p=(0,m.Z)(g,[["render",h],["__scopeId","data-v-07cb488b"]]);var v=p;const C={class:"auth-container"},f={class:"form-el"},w={class:"form-el"},I={class:"btn-container"};function b(t,e,s,o,i,c){return(0,r.wg)(),(0,r.iD)("div",C,[(0,r._)("form",null,[(0,r._)("div",f,[(0,r._)("label",{for:"name",class:(0,n.C_)({invalid:"invalid"===i.userEmailValidity})},"Email",2),(0,r.wy)((0,r._)("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>i.userName=t),id:"name",class:(0,n.C_)({invalid:"invalid"===i.userEmailValidity}),onBlur:e[1]||(e[1]=(...t)=>c.emailValidation&&c.emailValidation(...t))},null,34),[[a.nr,i.userName,void 0,{trim:!0}]])]),(0,r._)("div",w,[(0,r._)("label",{class:(0,n.C_)({invalid:"invalid"===i.userPasswordValidity}),for:"name"},"Password",2),(0,r.wy)((0,r._)("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>i.userPassword=t),id:"name",class:(0,n.C_)({invalid:"invalid"===i.userPasswordValidity}),onBlur:e[3]||(e[3]=(...t)=>c.passwordValidation&&c.passwordValidation(...t))},null,34),[[a.nr,i.userPassword,void 0,{trim:!0}]])])]),(0,r._)("div",I,[(0,r._)("button",{onClick:e[4]||(e[4]=(...t)=>c.register&&c.register(...t)),class:"btn-reg"},"Register"),(0,r._)("button",{onClick:e[5]||(e[5]=(...t)=>c.singIn&&c.singIn(...t)),class:"btn-sign"},"Sign In")])])}s(7658);var _=s(3977),y=s(9355);const k={apiKey:"AIzaSyDsUcosq4b0TP6gYDRLxNmfUh9LqiAamPc",authDomain:"vue-chat-71a26.firebaseapp.com",databaseURL:"https://vue-chat-71a26-default-rtdb.firebaseio.com",projectId:"vue-chat-71a26",storageBucket:"vue-chat-71a26.appspot.com",messagingSenderId:"170675291082",appId:"1:170675291082:web:94a472b68bcf4853894533",measurementId:"G-DGDC7LQ5N9"},E=(0,_.ZF)(k),S=(0,y.N8)(E);var U=S,$={data(){return{userName:"",userPassword:"",userPasswordValidity:"pending",userEmailValidity:"pending"}},methods:{test(){const t=[],e=(0,y.iH)(U,"users/");(0,y.jM)(e,(e=>{const s=e.val();Object.values(s).forEach((e=>t.push(e.username))),console.log(t)}))},passwordValidation(){""===this.userPassword||this.userPassword.length<6?this.userPasswordValidity="invalid":this.userPasswordValidity="valid"},emailValidation(){this.userName.includes("@")?this.userEmailValidity="valid":this.userEmailValidity="invalid"},register(){"valid"===this.userPasswordValidity&&"valid"===this.userEmailValidity&&(this.$store.dispatch("register",{userName:this.userName,userPassword:this.userPassword}),this.userName="",this.userPassword="")},singIn(){"valid"===this.userPasswordValidity&&"valid"===this.userEmailValidity&&(this.$store.dispatch("signIn",{userName:this.userName,userPassword:this.userPassword}),this.userName="",this.userPassword="")}}};const D=(0,m.Z)($,[["render",b],["__scopeId","data-v-37375040"]]);var M=D;const x={class:"chat-page-container"};function P(t,e,s,a,o,i){const n=(0,r.up)("chat-contacts"),c=(0,r.up)("chat-dialog");return(0,r.wg)(),(0,r.iD)("div",x,[(0,r.Wm)(n),(0,r.Wm)(c,{ref:"dialog"},null,512)])}const V={class:"contacts-container"},j={class:"search"},H={key:0},N={key:1},O={key:2};function A(t,e,s,o,i,c){const l=(0,r.up)("contact-item");return(0,r.wg)(),(0,r.iD)("div",V,[(0,r._)("div",j,[(0,r.wy)((0,r._)("input",{placeholder:"Search","onUpdate:modelValue":e[0]||(e[0]=t=>i.searchRequest=t),onInput:e[1]||(e[1]=(...t)=>c.getAllUsers&&c.getAllUsers(...t))},null,544),[[a.nr,i.searchRequest]]),(0,r._)("div",null,[(0,r._)("button",{onClick:e[2]||(e[2]=(...t)=>c.selectChat&&c.selectChat(...t)),class:(0,n.C_)(["btn",{active:i.chatsSelected}])}," Chats ",2),(0,r._)("button",{onClick:e[3]||(e[3]=(...t)=>c.selectContacts&&c.selectContacts(...t)),class:(0,n.C_)(["btn",{active:i.contactsSelected}])}," Contacts ",2)])]),(0,r._)("ul",null,["chats"===this.listMode&&0===this.$store.getters.getChats.length?((0,r.wg)(),(0,r.iD)("p",H," No Chats ")):(0,r.kq)("",!0),"contacts"===this.listMode&&0===this.$store.getters.getContacts.length?((0,r.wg)(),(0,r.iD)("p",N," No Contacts ")):(0,r.kq)("",!0),"search"===this.listMode&&0===this.search.length?((0,r.wg)(),(0,r.iD)("p",O," Nothing Found ")):(0,r.kq)("",!0),((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(c.search,(e=>((0,r.wg)(),(0,r.iD)("li",{key:e.id},[(0,r.Wm)(l,{name:e.name,id:e.id,onSelectContact:t.selectContact},null,8,["name","id","onSelectContact"])])))),128))])])}const q={class:"avatar"};function L(t,e,s,o,i,c){return(0,r.wg)(),(0,r.iD)("div",{onClick:e[3]||(e[3]=(0,a.iM)(((...t)=>c.selectContact&&c.selectContact(...t)),["self"])),class:"contact"},[(0,r._)("div",{onClick:e[0]||(e[0]=(...t)=>c.selectContact&&c.selectContact(...t))},[(0,r._)("div",q,(0,n.zw)(s.name[0].toUpperCase()),1),(0,r._)("p",null,(0,n.zw)(s.name),1)]),c.inContacts?((0,r.wg)(),(0,r.iD)("div",{key:0,class:"contact-badge",type:"button",onClick:e[1]||(e[1]=(...t)=>c.addContact&&c.addContact(...t))}," In Contacts ")):((0,r.wg)(),(0,r.iD)("button",{key:1,type:"button",onClick:e[2]||(e[2]=(...t)=>c.addContact&&c.addContact(...t))},"Add contact"))])}const T={props:["name","id"],computed:{color(){return this.$store.getters.getSelectedChat===this.id?"#2C7AE1":"transperent"},inContacts(){let t=this.$store.getters.getContactsIds;return t.includes(this.id)},colorHover(){return this.$store.getters.getSelectedChat===this.id?"#2C7AE1":"#c5c9d3"}},methods:{addContact(){this.$store.dispatch("addContact",{id:this.id,name:this.name})},selectContact(){this.$store.dispatch("selectContact",{id:this.id,name:this.name})}}},R=()=>{(0,a.sj)((t=>({"034e281e":t.color,"56a713be":t.colorHover})))},Z=T.setup;T.setup=Z?(t,e)=>(R(),Z(t,e)):R;var z=T;const B=(0,m.Z)(z,[["render",L],["__scopeId","data-v-0facc6ae"]]);var F=B,W={components:{ContactItem:F},data(){return{listMode:"contacts",chatsSelected:!1,contactsSelected:!0,allChats:[],allUsers:[],searchResult:[],searchRequest:""}},computed:{search(){return this.searchRequest?(this.listMode="search",this.allUsers.filter((t=>t.name.toLocaleLowerCase().includes(this.searchRequest.toLocaleLowerCase())))):this.chatsSelected?(this.listMode="chats",this.$store.getters.getChats):(this.listMode="contacts",this.$store.getters.getContacts)}},methods:{selectChat(){this.chatsSelected||(this.chatsSelected=!0,this.contactsSelected=!1)},selectContacts(){this.contactsSelected||(this.chatsSelected=!1,this.contactsSelected=!0)},getAllUsers(){if(0===this.allUsers.length){const t=(0,y.iH)(U,"Users/");(0,y.jM)(t,(t=>{const e=t.val();Object.values(e),this.allUsers=Object.values(e).filter((t=>t.id!==this.$store.getters.getUserId))}))}}}};const G=(0,m.Z)(W,[["render",A],["__scopeId","data-v-ebc3488e"]]);var K=G;const Y={class:"chat-dialog"},Q={key:0,id:"chat",class:"massage-list"},X={key:1},J={class:"massage-input"};function tt(t,e,s,o,i,n){const c=(0,r.up)("massage-item");return(0,r.wg)(),(0,r.iD)("div",Y,[this.massages.length>0?((0,r.wg)(),(0,r.iD)("ul",Q,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(this.massages,(t=>((0,r.wg)(),(0,r.iD)("li",{key:t.text},[(0,r.Wm)(c,{id:t.from,text:t.text},null,8,["id","text"])])))),128))])):((0,r.wg)(),(0,r.iD)("p",X,"No massages found")),(0,r._)("div",J,[(0,r.wy)((0,r._)("textarea",{placeholder:"Enter massage",id:"textArea",onInput:e[0]||(e[0]=t=>n.textAreaResize(t)),"onUpdate:modelValue":e[1]||(e[1]=t=>i.userInput=t)},null,544),[[a.nr,i.userInput]]),(0,r._)("button",{onClick:e[2]||(e[2]=(...t)=>n.sendMassage&&n.sendMassage(...t))},"Send")])])}const et={class:"cont"},st={class:"massage"};function at(t,e,s,a,o,i){return(0,r.wg)(),(0,r.iD)("div",et,[(0,r._)("div",st,(0,n.zw)(s.text),1)])}const rt={props:["text","id"],computed:{color(){return this.$store.getters.getUserId===this.id?"#2C7AE1":"#C5C9D3"},position(){return this.$store.getters.getUserId===this.id?"flex-end":"flex-start"}}},ot=()=>{(0,a.sj)((t=>({"753c0f55":t.position,"4a4148b7":t.color})))},it=rt.setup;rt.setup=it?(t,e)=>(ot(),it(t,e)):ot;var nt=rt;const ct=(0,m.Z)(nt,[["render",at],["__scopeId","data-v-10557251"]]);var lt=ct,dt={components:{MassageItem:lt},data(){return{userInput:"",massages:[]}},methods:{textAreaResize(t){t.target.style.height="70%",t.target.scrollHeight<70?t.target.style.height=`${t.target.scrollHeight}px`:t.target.style.height="70px"},sendMassage(){this.userInput&&(document.querySelector("textArea").style.height="70%",this.$store.dispatch("sendMassage",{text:this.userInput,from:this.$store.getters.getUserId}),this.userInput="");const t=document.getElementById("chat");t.scroll(0,t.scrollHeight)},async getMassages(t){const e=await(0,y.iH)(U,"/Chats/"+this.$store.getters.getUserId+"/"+t);await(0,y.jM)(e,(t=>{const e=t.val();this.massages=e?Object.values(e):[]}))}},computed:{chat(){return this.$store.getters.getSelectedChat}},watch:{chat(t){this.getMassages(t);document.getElementById("chat")}}};const ut=(0,m.Z)(dt,[["render",tt],["__scopeId","data-v-4f2da00c"]]);var ht=ut,gt={components:{ChatContacts:K,ChatDialog:ht},mounted(){this.$store.dispatch("getContacts"),this.$store.dispatch("getChats")}};const mt=(0,m.Z)(gt,[["render",P],["__scopeId","data-v-4399cb7c"]]);var pt=mt;const vt={class:"alert-out"},Ct={class:"alert-in"};function ft(t,e,s,a,o,i){return(0,r.wg)(),(0,r.iD)("div",vt,[(0,r._)("div",Ct,[(0,r._)("p",null,(0,n.zw)(this.$store.getters.getErrorMassage),1),(0,r._)("button",{onClick:e[0]||(e[0]=(...t)=>i.clearError&&i.clearError(...t))},"Dismis")])])}var wt={methods:{clearError(){this.$store.dispatch("clearError")}}};const It=(0,m.Z)(wt,[["render",ft],["__scopeId","data-v-763ee320"]]);var bt=It,_t={components:{UserAuth:M,ChatPage:pt,TheHeader:v,BaseAlert:bt},data(){return{hasError:!1,isLoggedIn:!1}},mounted(){this.$store.dispatch("autoLogin")},computed:{error(){return this.$store.getters.getErrorMassage}},watch:{error(){this.error?this.hasError=!0:this.hasError=!1}}};const yt=(0,m.Z)(_t,[["render",i]]);var kt=yt,Et=s(3907),St=s(9451),Ut=(0,Et.MT)({state(){return{contacts:[],chats:[],contactsIds:[],idToken:"",email:"",userId:"",selectedChat:"",erorrMassage:""}},getters:{getChats(t){return t.chats},getErrorMassage(t){return t.erorrMassage},getContacts(t){return t.contacts},getContactsIds(t){return t.contactsIds},getSelectedChat(t){return t.selectedChat.id},getUserId(t){return t.userId},userEmail(t){return t.email}},actions:{getChats(t){const e=(0,y.iH)(U,"Users/"+this.state.userId+"/chats");(0,y.jM)(e,(e=>{const s=e.val();s&&t.commit("getChats",Object.values(s))}))},clearError(t){t.commit("clearError")},getContacts(t){const e=(0,y.iH)(U,"Users/"+this.state.userId+"/contacts");(0,y.jM)(e,(e=>{const s=e.val();s&&(t.commit("getContacts",Object.values(s)),t.commit("getContactsIds",Object.keys(s)))}))},addContact(t,e){(0,y.t8)((0,y.iH)(U,"Users/"+this.state.userId+"/contacts/"+e.id),{name:e.name,id:e.id})},sendMassage(t,e){const s=(0,y.iH)(U,"Chats/"+this.state.userId+"/"+this.state.selectedChat.id),a=(0,y.VF)(s);(0,y.t8)(a,{text:e.text,from:e.from}),(0,y.t8)((0,y.iH)(U,"Users/"+this.state.userId+"/chats/"+this.state.selectedChat.id),{name:this.state.selectedChat.name,id:this.state.selectedChat.id}),(0,y.t8)((0,y.iH)(U,"Users/"+this.state.selectedChat.id+"/chats/"+this.state.userId),{name:this.state.email,id:this.state.userId});const r=(0,y.iH)(U,"Chats/"+this.state.selectedChat.id+"/"+this.state.userId),o=(0,y.VF)(r);(0,y.t8)(o,{text:e.text,from:e.from})},selectContact(t,e){e.name&&e.id,t.commit("selectContact",e)},logout(t){t.commit("logout")},signIn(t,e){(0,St.e5)((0,St.v0)(),e.userName,e.userPassword).then((e=>{localStorage.setItem("email",e.user.email),localStorage.setItem("id",e.user.uid),localStorage.setItem("token",e.user.accessToken),t.commit("setUser",e)})).catch((e=>t.commit("setError",e.message)))},autoLogin(t){const e=localStorage.getItem("email"),s=localStorage.getItem("token"),a=localStorage.getItem("id");e&&s&&a&&t.commit("autoSetUser",{token:s,email:e,id:a})},register(t,e){(0,St.Xb)((0,St.v0)(),e.userName,e.userPassword).then((e=>{localStorage.setItem("email",e.user.email),localStorage.setItem("id",e.user.uid),localStorage.setItem("token",e.user.accessToken),t.commit("setUser",e),(0,y.t8)((0,y.iH)(U,"Users/"+e.user.uid),{name:e.user.email,id:e.user.uid,contacts:[]})})).catch((e=>t.commit("setError",e.message)))}},mutations:{getChats(t,e){t.chats=e},getContacts(t,e){t.contacts=e.filter((e=>e.id!==t.userId))},getContactsIds(t,e){t.contactsIds=e.filter((e=>e!==t.userId))},selectContact(t,e){t.selectedChat=e},logout(t){t.email="",t.idToken="",localStorage.removeItem("email"),localStorage.removeItem("token"),localStorage.removeItem("id")},autoSetUser(t,e){t.idToken=e.token,t.userId=e.id,t.email=e.email},setUser(t,e){t.idToken=e.user.accessToken,t.userId=e.user.uid,t.email=e.user.email},setError(t,e){t.erorrMassage=e},clearError(t){t.erorrMassage=""}}});(0,a.ri)(kt).use(Ut).mount("#app")}},e={};function s(a){var r=e[a];if(void 0!==r)return r.exports;var o=e[a]={exports:{}};return t[a].call(o.exports,o,o.exports,s),o.exports}s.m=t,function(){var t=[];s.O=function(e,a,r,o){if(!a){var i=1/0;for(d=0;d<t.length;d++){a=t[d][0],r=t[d][1],o=t[d][2];for(var n=!0,c=0;c<a.length;c++)(!1&o||i>=o)&&Object.keys(s.O).every((function(t){return s.O[t](a[c])}))?a.splice(c--,1):(n=!1,o<i&&(i=o));if(n){t.splice(d--,1);var l=r();void 0!==l&&(e=l)}}return e}o=o||0;for(var d=t.length;d>0&&t[d-1][2]>o;d--)t[d]=t[d-1];t[d]=[a,r,o]}}(),function(){s.d=function(t,e){for(var a in e)s.o(e,a)&&!s.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={143:0};s.O.j=function(e){return 0===t[e]};var e=function(e,a){var r,o,i=a[0],n=a[1],c=a[2],l=0;if(i.some((function(e){return 0!==t[e]}))){for(r in n)s.o(n,r)&&(s.m[r]=n[r]);if(c)var d=c(s)}for(e&&e(a);l<i.length;l++)o=i[l],s.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return s.O(d)},a=self["webpackChunkvue_chat"]=self["webpackChunkvue_chat"]||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))}();var a=s.O(void 0,[998],(function(){return s(9522)}));a=s.O(a)})();
//# sourceMappingURL=app.747218e7.js.map